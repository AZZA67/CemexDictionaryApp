@model List<CemexDictionaryApp.Models.Product>
@*@TempData["Success"]*@

          <div class="page-header d-print-none">
            <div class="row g-2 align-items-center">
              <div class="col">
                <h2 class="page-title">
                  
                </h2>
              </div>
            </div>
          </div>

<div class="col-12">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-easel3" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8.5 13.134V12h5a1.5 1.5 0 0 0 1.5-1.5V2h.5a.5.5 0 0 0 0-1H.5a.5.5 0 0 0 0 1H1v8.5A1.5 1.5 0 0 0 2.5 12h5v1.134a1 1 0 1 0 1 0ZM2 2v8.5a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V2H2Z"/>
</svg>
              |    
                Products</h3>
        
            
            </div>
        <div class="card-body border-bottom py-3">
            <div class="d-flex">
                <a style="margin-left:50px" onclick="modaladd()" class="btn btn-primary d-none d-sm-inline-block">
                    Add New Product
                </a>
            </div>
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
                  <div class="col-12">
                <div class="card">
        
        <div class="table-responsive">
            <table id="TblInfo" class="table card-table table-vcenter text-nowrap table-borderless ">
                <thead>
                    <tr>
                        <th>Product No.</th>
                        <th>Name </th>
                        <th> Image</th>
                        <th>Description</th>
                        <th>Type</th>
                        <th>Status</th>
                        <th>Details</th>
                        <th>Change Status</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (Product item in Model)
                    {
                        <tr>
                            <td><span class="text-muted">@item.Id </span></td>
                            <td><a href="invoice.html" class="text-reset" tabindex="-1">@item.Name</a></td>
                            <td data-label="Name">
                                <div class="d-flex py-1 align-items-center">
                                    <Img class="avatar me-2" src="~/images/@item.Image">
                                </div>
                            </td>
                            <td>
                                @item.Description
                            </td>

                            <td>
                                @item.Type
                            </td>
                            <td id="@item.Id">
                                <span class="badge bg-success me-1"></span> @item.Status
                            </td>
                            <td>
                                <span class="text-muted">
                                    <button onclick="modal(@item.Id)" class="btn align-text-top" id="details" data-id="@item.Id" data-bs-boundary="viewport">Details</button>
                                </span>
                            </td>
                            <td>
                                <span class="text-end">
                                    <button onclick="toggle(@item.Id)" class="btn  align-text-top" data-bs-boundary="viewport">toggle</button>
                                </span>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        </div>
        </div>


    </div>
</div>
<div class="modal" id="exampleModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div id='myModalContent' class="card p-3 bg-white"></div>
        </div>
    </div>

</div>



<div class="modal modal-blur fade " id="exampleModal2">
    <div class="modal-dialog">
        <div class="modal-content">
            <div id='myModalContent2' class="card"></div>
        </div>
    </div>

</div>







<div class="modal modal-blur fade" id="modal-success" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="modal-status bg-success"></div>
            <div class="modal-body text-center py-4">
                <!-- Download SVG icon from http://tabler-icons.io/i/circle-check -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-green icon-lg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><circle cx="12" cy="12" r="9" /><path d="M9 12l2 2l4 -4" /></svg>
                <h3>Product Added Successfully!</h3>

            </div>
            <div class="modal-footer">
                <div class="w-100">
                    <div class="row">
                        <div class="col">
                            <a asp-action="HomePage" asp-controller="Home" class="btn w-100" data-bs-dismiss="modal">
                                Go to dashboard
                            </a>
                        </div>
                        <div class="col">
                            <a asp-action="GetAllProducts" asp-controller="Product" asp-route-page_number="1" class="btn btn-success w-100" data-bs-dismiss="modal">
                                Go To All Products
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>



    <script type="text/javascript">
        $(document).ready(function () { 
            $('#TblInfo').DataTable({
                "paging": true,
                 columnDefs: [
                    {
                        targets: -1,
                        className: 'table-borderless'
                    }
                     ]
            });
           
        });

        function toggle(itemid) {
            if (itemid != 0) {
                $.ajax(
                    {
                        type: "GET",
                        url: "/Product/ChangeProductStatusById",
                        data: { "productId": itemid },
                        success: function (result) {
                            console.log(result);


                            document.getElementById(itemid).innerHTML = result;

                        }
                    }
                );
            }
        }
        function modal(itemid) {

            if (itemid != 0) {
                var options = { "backdrop": "static", keyboard: true };
                $.ajax({
                    type: "GET",
                    url: "/Product/Details/${itemid}",
                    contentType: "application/json; charset=utf-8",
                    data: { "productId": itemid },
                    datatype: "json",

                    success: function (data) {

                        $('#myModalContent').html(data); //card
                        $('#myModal').modal(options);
                        $('#exampleModal').modal('show');

                    },
                    error: function () {
                        alert("Dynamic content load failed.");
                    }
                });
            }
        }

        function modaladd() {


            var options = { "backdrop": "static", keyboard: true };
            $.ajax({
              
                type: "GET",
                url: "/Product/AddNewProduct",
                contentType: "application/json; charset=utf-8",
                datatype: "json",

                success: function (data) {
                    debugger
                    $('#myModalContent2').html(data); //modal
                    $('#myModal').modal(options);
                    $('#exampleModal2').modal('show');

                },
                error: function () {
                    alert("Dynamic content load failed.");
                }
            });


        }


  $(function () {

            var success = '@TempData["Success"]';
            console.log(success);
            if (success == "true") {

              
                $('#modal-success').modal('show');
            }
        })


      
    </script>

}